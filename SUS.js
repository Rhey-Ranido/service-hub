const susData = {
  data: [
    [4, 1, 5, 1, 4, 2, 5, 1, 2, 1],
    [5, 1, 3, 1, 5, 1, 5, 1, 5, 1],
    [5, 1, 3, 1, 5, 1, 5, 1, 5, 1],
    [5, 5, 5, 5, 5, 5, 5, 5, 5, 5],
    [5, 1, 3, 1, 5, 1, 5, 1, 5, 1],
    [5, 1, 3, 1, 5, 1, 5, 1, 5, 1],
    [5, 1, 3, 1, 5, 1, 5, 1, 5, 1],
    [5, 2, 3, 5, 5, 2, 5, 2, 5, 2],
    [5, 1, 5, 5, 5, 1, 5, 3, 5, 2],
    [4, 1, 5, 1, 4, 2, 5, 1, 2, 1],
    [5, 1, 3, 1, 5, 1, 5, 1, 5, 1],
    [5, 1, 3, 1, 5, 1, 5, 1, 5, 1],
    [5, 5, 5, 5, 5, 5, 5, 5, 5, 5],
    [5, 1, 3, 1, 5, 1, 5, 1, 5, 1],
    [5, 1, 3, 1, 5, 1, 5, 1, 5, 1],
    [5, 1, 3, 1, 5, 1, 5, 1, 5, 1],
    [5, 2, 3, 5, 5, 2, 5, 2, 5, 2],
    [5, 1, 5, 5, 5, 1, 5, 3, 5, 2],
    [5, 1, 3, 1, 5, 1, 5, 1, 5, 1],
    [5, 1, 3, 1, 5, 1, 5, 1, 5, 1],
    [5, 1, 3, 1, 5, 1, 5, 1, 5, 1],
    [5, 1, 3, 1, 5, 1, 5, 1, 5, 1],
    [5, 1, 3, 1, 5, 1, 5, 1, 5, 1],
    [5, 1, 3, 1, 5, 1, 5, 1, 5, 1],
    [5, 1, 3, 1, 5, 1, 5, 1, 5, 1],
    [5, 1, 3, 1, 5, 1, 5, 1, 5, 1],
    [5, 1, 3, 1, 5, 1, 5, 1, 5, 1],
    [5, 1, 3, 1, 5, 1, 5, 1, 5, 1],
    [5, 1, 3, 1, 5, 1, 5, 1, 5, 1],
    [5, 1, 3, 1, 5, 1, 5, 1, 5, 1],
    [5, 1, 3, 1, 5, 1, 5, 1, 5, 1],
    [5, 1, 3, 1, 5, 1, 5, 1, 5, 1],
    [5, 1, 3, 1, 5, 1, 5, 1, 5, 1],
    [5, 1, 3, 1, 5, 1, 5, 1, 5, 1],
    [5, 1, 3, 1, 5, 1, 5, 1, 5, 1],
    [5, 1, 3, 1, 5, 1, 5, 1, 5, 1],
    [5, 1, 3, 1, 5, 1, 5, 1, 5, 1],
    [5, 1, 3, 1, 5, 1, 5, 1, 5, 1],
    [5, 1, 3, 1, 5, 1, 5, 1, 5, 1],
    [5, 1, 3, 1, 5, 1, 5, 1, 5, 1],
    [5, 1, 3, 1, 5, 1, 5, 1, 5, 1],
    [5, 1, 3, 1, 5, 1, 5, 1, 5, 1],
    [5, 1, 3, 1, 5, 1, 5, 1, 5, 1],
    [5, 1, 3, 1, 5, 1, 5, 1, 5, 1],
    [5, 1, 3, 1, 5, 1, 5, 1, 5, 1],
    [5, 1, 3, 1, 5, 1, 5, 1, 5, 1],
    [4, 1, 5, 1, 4, 2, 5, 1, 2, 1],
    [5, 1, 3, 1, 5, 1, 5, 1, 5, 1],
    [5, 1, 3, 1, 5, 1, 5, 1, 5, 1],
    [5, 5, 5, 5, 5, 5, 5, 5, 5, 5],
    [5, 1, 3, 1, 5, 1, 5, 1, 5, 1],
    [4, 1, 5, 1, 4, 2, 5, 1, 2, 1],
    [5, 1, 3, 1, 5, 1, 5, 1, 5, 1],
    [5, 1, 3, 1, 5, 1, 5, 1, 5, 1],
    [5, 5, 5, 5, 5, 5, 5, 5, 5, 5],
    [5, 1, 3, 1, 5, 1, 5, 1, 5, 1],
    [4, 1, 5, 1, 4, 2, 5, 1, 2, 1],
    [5, 1, 3, 1, 5, 1, 5, 1, 5, 1],
    [5, 1, 3, 1, 5, 1, 5, 1, 5, 1],
    [5, 5, 5, 5, 5, 5, 5, 5, 5, 5],
    [5, 1, 3, 1, 5, 1, 5, 1, 5, 1],
    [4, 1, 5, 1, 4, 2, 5, 1, 2, 1],
    [5, 5, 5, 5, 5, 5, 5, 5, 5, 5],
  ]
};

/**
 * Calculate SUS (System Usability Scale) score for a single response
 * @param {Array} responses - Array of 10 responses (1-5 scale)
 * @returns {number} SUS score (0-100)
 */
function calculateSUSScore(responses) {
  if (!Array.isArray(responses) || responses.length !== 10) {
    throw new Error('Responses must be an array of exactly 10 values');
  }

  let totalScore = 0;

  for (let i = 0; i < 10; i++) {
    const response = responses[i];
    
    // Validate response is between 1-5
    if (response < 1 || response > 5) {
      throw new Error(`Response ${i + 1} must be between 1 and 5, got ${response}`);
    }

    // Calculate adjusted score
    if (i % 2 === 0) {
      // Odd-numbered questions (index 0, 2, 4, 6, 8 = questions 1, 3, 5, 7, 9)
      totalScore += response - 1;
    } else {
      // Even-numbered questions (index 1, 3, 5, 7, 9 = questions 2, 4, 6, 8, 10)
      totalScore += 5 - response;
    }
  }

  // Multiply by 2.5 to get final SUS score
  return totalScore * 2.5;
}

/**
 * Calculate SUS scores for all responses in the dataset
 * @param {Array} data - Array of response arrays
 * @returns {Object} Object containing individual scores, average, and statistics
 */
function calculateAllSUSScores(data = susData.data) {
  const scores = data.map((responses, index) => {
    try {
      return {
        responseIndex: index,
        responses: responses,
        susScore: calculateSUSScore(responses)
      };
    } catch (error) {
      return {
        responseIndex: index,
        responses: responses,
        error: error.message,
        susScore: null
      };
    }
  });

  const validScores = scores.filter(s => s.susScore !== null).map(s => s.susScore);
  
  const statistics = {
    count: validScores.length,
    average: validScores.length > 0 ? validScores.reduce((sum, score) => sum + score, 0) / validScores.length : 0,
    min: validScores.length > 0 ? Math.min(...validScores) : 0,
    max: validScores.length > 0 ? Math.max(...validScores) : 0,
    median: validScores.length > 0 ? getMedian(validScores) : 0
  };

  return {
    individualScores: scores,
    statistics: statistics,
    interpretation: interpretSUSScore(statistics.average)
  };
}

/**
 * Get median value from array of numbers
 * @param {Array} numbers - Array of numbers
 * @returns {number} Median value
 */
function getMedian(numbers) {
  const sorted = [...numbers].sort((a, b) => a - b);
  const mid = Math.floor(sorted.length / 2);
  return sorted.length % 2 === 0 
    ? (sorted[mid - 1] + sorted[mid]) / 2 
    : sorted[mid];
}

/**
 * Interpret SUS score based on standard benchmarks
 * @param {number} score - SUS score
 * @returns {string} Interpretation
 */
function interpretSUSScore(score) {
  if (score >= 80.3) return 'Excellent';
  if (score >= 68) return 'Good';
  if (score >= 51) return 'Poor';
  return 'Awful';
}

// Export functions for use
if (typeof module !== 'undefined' && module.exports) {
  module.exports = {
    susData,
    calculateSUSScore,
    calculateAllSUSScores,
    interpretSUSScore
  };
}

// Example usage and testing
console.log('=== SUS Score Calculator ===\n');

// Calculate scores for all responses
const results = calculateAllSUSScores();

console.log('Statistics:');
console.log(`Total responses: ${results.statistics.count}`);
console.log(`Average SUS score: ${results.statistics.average.toFixed(1)}`);
console.log(`Median SUS score: ${results.statistics.median.toFixed(1)}`);
console.log(`Min SUS score: ${results.statistics.min}`);
console.log(`Max SUS score: ${results.statistics.max}`);
console.log(`Overall interpretation: ${results.interpretation}\n`);

// Show first few individual scores as examples
console.log('First 5 individual scores:');
results.individualScores.slice(0, 5).forEach((result, index) => {
  if (result.error) {
    console.log(`Response ${index + 1}: ERROR - ${result.error}`);
  } else {
    console.log(`Response ${index + 1}: ${result.susScore} (${interpretSUSScore(result.susScore)})`);
  }
});

// Test with a single response
// console.log('\n=== Single Score Example ===');
// const testResponse = [4, 2, 3, 4, 5, 3, 4, 2, 4, 3];
// const testScore = calculateSUSScore(testResponse);
// console.log(`Test response: [${testResponse.join(', ')}]`);
// console.log(`SUS Score: ${testScore} (${interpretSUSScore(testScore)})`);